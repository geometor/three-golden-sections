/**
 * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

!function(t,n){"function"==typeof define&&define.amd?define(n):"object"==typeof module&&"object"==typeof module.exports?module.exports=n():(t.libGlobalName=n(),window.coffeequate=window.CQ=n())}(this,function(){var t,n,e;return function(r){function i(t,n){return v.call(t,n)}function o(t,n){var e,r,i,o,l,a,s,u,h,c,p,f=n&&n.split("/"),y=w.map,d=y&&y["*"]||{};if(t&&"."===t.charAt(0))if(n){for(t=t.split("/"),l=t.length-1,w.nodeIdCompat&&_.test(t[l])&&(t[l]=t[l].replace(_,"")),t=f.slice(0,f.length-1).concat(t),h=0;h<t.length;h+=1)if(p=t[h],"."===p)t.splice(h,1),h-=1;else if(".."===p){if(1===h&&(".."===t[2]||".."===t[0]))break;h>0&&(t.splice(h-1,2),h-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((f||d)&&y){for(e=t.split("/"),h=e.length;h>0;h-=1){if(r=e.slice(0,h).join("/"),f)for(c=f.length;c>0;c-=1)if(i=y[f.slice(0,c).join("/")],i&&(i=i[r])){o=i,a=h;break}if(o)break;!s&&d&&d[r]&&(s=d[r],u=h)}!o&&s&&(o=s,a=u),o&&(e.splice(0,a,o),t=e.join("/"))}return t}function l(t,n){return function(){var e=x.call(arguments,0);return"string"!=typeof e[0]&&1===e.length&&e.push(null),f.apply(r,e.concat([t,n]))}}function a(t){return function(n){return o(n,t)}}function s(t){return function(n){g[t]=n}}function u(t){if(i(m,t)){var n=m[t];delete m[t],b[t]=!0,p.apply(r,n)}if(!i(g,t)&&!i(b,t))throw new Error("No "+t);return g[t]}function h(t){var n,e=t?t.indexOf("!"):-1;return e>-1&&(n=t.substring(0,e),t=t.substring(e+1,t.length)),[n,t]}function c(t){return function(){return w&&w.config&&w.config[t]||{}}}var p,f,y,d,g={},m={},w={},b={},v=Object.prototype.hasOwnProperty,x=[].slice,_=/\.js$/;y=function(t,n){var e,r=h(t),i=r[0];return t=r[1],i&&(i=o(i,n),e=u(i)),i?t=e&&e.normalize?e.normalize(t,a(n)):o(t,n):(t=o(t,n),r=h(t),i=r[0],t=r[1],i&&(e=u(i))),{f:i?i+"!"+t:t,n:t,pr:i,p:e}},d={require:function(t){return l(t)},exports:function(t){var n=g[t];return"undefined"!=typeof n?n:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:c(t)}}},p=function(t,n,e,o){var a,h,c,p,f,w,v=[],x=typeof e;if(o=o||t,"undefined"===x||"function"===x){for(n=!n.length&&e.length?["require","exports","module"]:n,f=0;f<n.length;f+=1)if(p=y(n[f],o),h=p.f,"require"===h)v[f]=d.require(t);else if("exports"===h)v[f]=d.exports(t),w=!0;else if("module"===h)a=v[f]=d.module(t);else if(i(g,h)||i(m,h)||i(b,h))v[f]=u(h);else{if(!p.p)throw new Error(t+" missing "+h);p.p.load(p.n,l(o,!0),s(h),{}),v[f]=g[h]}c=e?e.apply(g[t],v):void 0,t&&(a&&a.exports!==r&&a.exports!==g[t]?g[t]=a.exports:c===r&&w||(g[t]=c))}else t&&(g[t]=e)},t=n=f=function(t,n,e,i,o){if("string"==typeof t)return d[t]?d[t](n):u(y(t,n).f);if(!t.splice){if(w=t,w.deps&&f(w.deps,w.callback),!n)return;n.splice?(t=n,n=e,e=null):t=r}return n=n||function(){},"function"==typeof e&&(e=i,i=o),i?p(r,t,n,e):setTimeout(function(){p(r,t,n,e)},4),f},f.config=function(t){return f(t)},t._defined=g,e=function(t,n,e){if("string"!=typeof t)throw new Error("See almond README: incorrect module build, no module name");n.splice||(e=n,n=[]),i(g,t)||i(m,t)||(m[t]=[t,n,e])},e.amd={jQuery:!0}}(),e("../node_modules/almond/almond",function(){}),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;e("nodes",[],function(){var n,e,r;return n=function(){function t(t){this.label=t}return t.prototype.getChildren=function(){return[]},t.prototype.getAllVariables=function(){return[]},t.prototype.toDrawingNode=function(){throw new Error("toDrawingNode not implemented for "+self.toString())},t.prototype.toLaTeX=function(){return this.toDrawingNode().renderLaTeX()},t.prototype.toString=function(){return this.toDrawingNode().renderString()},t.prototype.toMathML=function(){return this.toDrawingNode().renderMathML()},t.prototype.stringEqual=function(t){return t.toString()===this.toString()},t.prototype.approx=function(){var t;return t=this.constructor.approx,this.getChildren().map(function(t){return t.approx()}).reduce(function(n,e){return t(n,e)})},t}(),r=function(n){function e(t,n){this.children=null!=n?n:null,null==this.children&&(this.children=[]),e.__super__.constructor.call(this,t)}return t(e,n),e.prototype.getChildren=function(){return this.children},e}(n),e=function(n){function e(t,n,e){this.label=t,this.children={left:n,right:e}}return t(e,n),e.prototype.getChildren=function(){return[this.children.left,this.children.right]},e}(n),{BasicNode:n,RoseNode:r,BinaryNode:e}})}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;e("parse",["require"],function(n){function e(t){var e=function(){function n(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,expressions:3,e:4,EOF:5,"+":6,"-":7,"*":8,"/":9,"**":10,"(":11,")":12,TERMINAL:13,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",6:"+",7:"-",8:"*",9:"/",10:"**",11:"(",12:")",13:"TERMINAL"},productions_:[0,[3,2],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,3],[4,1]],performAction:function(n,e,r,i,o,l){var a=l.length-1;switch(o){case 1:return l[a-1];case 2:this.$=new t.Add(l[a-2],l[a]);break;case 3:this.$=new t.Add(l[a-2],new t.Mul("-1",l[a]));break;case 4:this.$=new t.Mul(l[a-2],l[a]);break;case 5:this.$=new t.Mul(l[a-2],new t.Pow(l[a],"-1"));break;case 6:this.$=new t.Pow(l[a-2],l[a]);break;case 7:this.$=new t.Mul("-1",l[a]);break;case 8:this.$=l[a-1];break;case 9:this.$=u(n.trim())}},table:[{3:1,4:2,7:[1,3],11:[1,4],13:[1,5]},{1:[3]},{5:[1,6],6:[1,7],7:[1,8],8:[1,9],9:[1,10],10:[1,11]},{4:12,7:[1,3],11:[1,4],13:[1,5]},{4:13,7:[1,3],11:[1,4],13:[1,5]},{5:[2,9],6:[2,9],7:[2,9],8:[2,9],9:[2,9],10:[2,9],12:[2,9]},{1:[2,1]},{4:14,7:[1,3],11:[1,4],13:[1,5]},{4:15,7:[1,3],11:[1,4],13:[1,5]},{4:16,7:[1,3],11:[1,4],13:[1,5]},{4:17,7:[1,3],11:[1,4],13:[1,5]},{4:18,7:[1,3],11:[1,4],13:[1,5]},{5:[2,7],6:[2,7],7:[2,7],8:[2,7],9:[2,7],10:[2,7],12:[2,7]},{6:[1,7],7:[1,8],8:[1,9],9:[1,10],10:[1,11],12:[1,19]},{5:[2,2],6:[2,2],7:[2,2],8:[1,9],9:[1,10],10:[1,11],12:[2,2]},{5:[2,3],6:[2,3],7:[2,3],8:[1,9],9:[1,10],10:[1,11],12:[2,3]},{5:[2,4],6:[2,4],7:[2,4],8:[2,4],9:[2,4],10:[1,11],12:[2,4]},{5:[2,5],6:[2,5],7:[2,5],8:[2,5],9:[2,5],10:[1,11],12:[2,5]},{5:[2,6],6:[2,6],7:[2,6],8:[2,6],9:[2,6],10:[2,6],12:[2,6]},{5:[2,8],6:[2,8],7:[2,8],8:[2,8],9:[2,8],10:[2,8],12:[2,8]}],defaultActions:{6:[2,1]},parseError:function(t,n){if(!n.recoverable)throw new Error(t);this.trace(t)},parse:function(t){function n(){var t;return t=e.lexer.lex()||p,"number"!=typeof t&&(t=e.symbols_[t]||t),t}var e=this,r=[0],i=[null],o=[],l=this.table,a="",s=0,u=0,h=0,c=2,p=1,f=o.slice.call(arguments,1);this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var y=this.lexer.yylloc;o.push(y);var d=this.lexer.options&&this.lexer.options.ranges;this.parseError="function"==typeof this.yy.parseError?this.yy.parseError:Object.getPrototypeOf(this).parseError;for(var g,m,w,b,v,x,_,S,A,M={};;){if(w=r[r.length-1],this.defaultActions[w]?b=this.defaultActions[w]:((null===g||"undefined"==typeof g)&&(g=n()),b=l[w]&&l[w][g]),"undefined"==typeof b||!b.length||!b[0]){var V="";A=[];for(x in l[w])this.terminals_[x]&&x>c&&A.push("'"+this.terminals_[x]+"'");V=this.lexer.showPosition?"Parse error on line "+(s+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+A.join(", ")+", got '"+(this.terminals_[g]||g)+"'":"Parse error on line "+(s+1)+": Unexpected "+(g==p?"end of input":"'"+(this.terminals_[g]||g)+"'"),this.parseError(V,{text:this.lexer.match,token:this.terminals_[g]||g,line:this.lexer.yylineno,loc:y,expected:A})}if(b[0]instanceof Array&&b.length>1)throw new Error("Parse Error: multiple actions possible at state: "+w+", token: "+g);switch(b[0]){case 1:r.push(g),i.push(this.lexer.yytext),o.push(this.lexer.yylloc),r.push(b[1]),g=null,m?(g=m,m=null):(u=this.lexer.yyleng,a=this.lexer.yytext,s=this.lexer.yylineno,y=this.lexer.yylloc,h>0&&h--);break;case 2:if(_=this.productions_[b[1]][1],M.$=i[i.length-_],M._$={first_line:o[o.length-(_||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(_||1)].first_column,last_column:o[o.length-1].last_column},d&&(M._$.range=[o[o.length-(_||1)].range[0],o[o.length-1].range[1]]),v=this.performAction.apply(M,[a,u,s,this.yy,b[1],i,o].concat(f)),"undefined"!=typeof v)return v;_&&(r=r.slice(0,-1*_*2),i=i.slice(0,-1*_),o=o.slice(0,-1*_)),r.push(this.productions_[b[1]][0]),i.push(M.$),o.push(M._$),S=l[r[r.length-2]][r[r.length-1]],r.push(S);break;case 3:return!0}}return!0}},r=function(){var t={EOF:1,parseError:function(t,n){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,n)},setInput:function(t){return this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var n=t.match(/(?:\r\n?|\n).*/g);return n?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var n=t.length,e=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-n-1),this.offset-=n;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),e.length-1&&(this.yylineno-=e.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:e?(e.length===r.length?this.yylloc.first_column:0)+r[r.length-e.length].length-e[0].length:this.yylloc.first_column-n},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-n]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),n=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+n+"^"},test_match:function(t,n){var e,r,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),r=t[0].match(/(?:\r\n?|\n).*/g),r&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,n,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e)return e;if(this._backtrack){for(var o in i)this[o]=i[o];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,n,e,r;this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),o=0;o<i.length;o++)if(e=this._input.match(this.rules[i[o]]),e&&(!n||e[0].length>n[0].length)){if(n=e,r=o,this.options.backtrack_lexer){if(t=this.test_match(e,i[o]),t!==!1)return t;if(this._backtrack){n=!1;continue}return!1}if(!this.options.flex)break}return n?(t=this.test_match(n,i[r]),t!==!1?t:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){var t=this.conditionStack.length-1;return t>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return t=this.conditionStack.length-1-Math.abs(t||0),t>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,n,e,r){switch(e){case 0:break;case 1:return 13;case 2:return 13;case 3:return 10;case 4:return 8;case 5:return 9;case 6:return 6;case 7:return 7;case 8:return 11;case 9:return 12;case 10:return 5}},rules:[/^(?:\s+)/,/^(?:[\-]?[0-9]+(\.[0-9]+)?e[\-+]?[0-9]+(\.[0-9]+)?)/,/^(?:[^()+\-*/]+)/,/^(?:\*\*)/,/^(?:\*)/,/^(?:\/)/,/^(?:\+)/,/^(?:-)/,/^(?:\()/,/^(?:\))/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10],inclusive:!0}}};return t}();return e.lexer=r,n.prototype=e,e.Parser=n,new n}();return"undefined"!=typeof n&&"undefined"!=typeof exports&&(exports.parser=e,exports.Parser=e.Parser,exports.parse=function(){return e.parse.apply(e,arguments)},exports.main=function(t){t[1]||(console.log("Usage: "+t[0]+" FILE"),process.exit(1));var e=n("fs").readFileSync(n("path").normalize(t[1]),"utf8");return exports.parser.parse(e)},"undefined"!=typeof module&&n.main===module&&exports.main(process.argv.slice(1))),e}var r,i,o,l,a,s,u;return l=function(n){function e(t,n){this.input=t,this.type=n}return t(e,n),e.prototype.toString=function(){return"Could not parse '"+this.input+"' as "+this.type},e}(Error),s=/^@*[a-zA-Z\u0391-\u03A9\u03B1-\u03C9ϕϖϱϰϑϵ][a-zA-Z\u0391-\u03A9\u03B1-\u03C9ϕϖϱϰϑϵ_\-\d]*$/,i=/^-?\d+$/,r=/^-?\d+(\.\d+)?(e-?\d+)?$/,a=/^\\@*[a-zA-Z\u0391-\u03A9\u03B1-\u03C9ϕϖϱϰϑϵ][a-zA-Z\u0391-\u03A9\u03B1-\u03C9ϕϖϱϰϑϵ_\-\d]*$/,o=/^[^:]*::\{[^:+]*\}$/,u=function(t){var h,c,p;if(/\^/.test(t))throw new Error("Unexpected carat (^). Coffeequate uses ** for exponentiation.");if(o.test(t))return h=t.split("::"),c=u(h[0]),c.units=e.parse(h[1].slice(1,h[1].length-1)),c;if(t=t.trim(),p=n("terminals"),i.test(t))return new p.Constant(t,1,"rational");if(r.test(t))return new p.Constant(t,1,"float");if(s.test(t))return new p.Variable(t);if(a.test(t))return new p.SymbolicConstant(t.slice(1));throw new l(t,"terminal")},{ParseError:l,SyntaxError:e.SyntaxError,stringToExpression:function(t,r){var i,o;return null==r&&(r=!0),o=n("operators"),i=e(o).parse(t),r&&null!=i.simplify?i.simplify():i},stringToTerminal:u}})}.call(this),function(){var t,n=[].slice,r=function(t,n){function e(){this.constructor=t}for(var r in n)i.call(n,r)&&(t[r]=n[r]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t},i={}.hasOwnProperty;t={"α":"\\alpha ",A:"A","β":"\\beta ",B:"B","χ":"\\chi ","Δ":"\\Delta ","δ":"\\delta ","ε":"\\varepsilon ","ϵ":"\\epsilon ",E:"E","Η":"\\Eta ","γ":"\\gamma ","Γ":"\\Gamma ","ι":"\\iota ","Ι":"I","κ":"\\kappa ","ϰ":"\\varkappa ","Κ":"K","λ":"\\lambda ","Λ":"\\Lambda ","μ":"\\mu ","Μ":"M","ν":"\\nu ","Ν":"N","ω":"\\omega ","Ω":"\\Omega ","ℴ":"o",O:"O","ϕ":"\\phi ","φ":"\\varphi ","Φ":"\\Phi ","π":"\\pi ","Π":"\\Pi ","ψ":"\\psi ","Ψ":"\\Psi ","ρ":"\\rho ","Ρ":"P","σ":"\\sigma ","ς":"\\varsigma ","Σ":"\\Sigma ","τ":"\\tau ","Τ":"T","θ":"\\theta ","Θ":"\\Theta ","υ":"\\upsilon ","ξ":"\\xi ","Ξ":"\\Xi ","ζ":"\\zeta ","Ζ":"Z","ϖ":"\\varpi ","ϱ":"\\varrho ","ϑ":"\\vartheta "},e("prettyRender",[],function(){var e;return e={},e.DrawingNode=function(){function t(){}return t.prototype.toString=function(){throw new Error("not implemented")},t.prototype.renderLaTeX=function(){throw new Error("not implemented")},t.prototype.bindingStrength=function(){return 8},t.prototype.bracketIfNeeded=function(t){return t.bindingStrength()<=this.bindingStrength()?new e.Bracket(t):t},t}(),e.DrawingNode.makeWithBrackets=function(){var t,r;return r=1<=arguments.length?n.call(arguments,0):[],t=new this,r=r.map(function(n){return n.bindingStrength()<=t.bindingStrength()?new e.Bracket(n):n}),t.terms=r,t},e.Add=function(t){function i(){var t;t=1<=arguments.length?n.call(arguments,0):[],this.terms=t}return r(i,t),i.prototype.bindingStrength=function(){return 4},i.prototype.drawPretty=function(t,n,r){var i,o,l,a,s;for(l="",this.terms[0]instanceof e.Negate?(l+=r,l+=this.terms[0].contents[t]()):l+=this.terms[0][t](),a=this.terms.slice(1),i=0,o=a.length;o>i;i++)s=a[i],s instanceof e.Negate?(l+=r,l+=s.contents[t]()):(l+=n,l+=s[t]());return l},i.prototype.renderLaTeX=function(){return this.drawPretty("renderLaTeX","+","-")},i.prototype.renderString=function(){return this.drawPretty("renderString"," + "," - ")},i.prototype.renderMathML=function(){return this.drawPretty("renderMathML","<mo>+</mo>","<mo>-</mo>")},i}(e.DrawingNode),e.Mul=function(t){function e(){var t;t=1<=arguments.length?n.call(arguments,0):[],this.terms=t}return r(e,t),e.prototype.bindingStrength=function(){return 6},e.prototype.renderLaTeX=function(){return this.terms.map(function(t){return t.renderLaTeX()}).join(" \\cdot ")},e.prototype.renderString=function(){return this.terms.map(function(t){return t.renderString()}).join("*")},e.prototype.renderMathML=function(){return this.terms.map(function(t){return t.renderMathML()}).join("<mo>&middot;</mo>")},e}(e.DrawingNode),e.Pow=function(t){function n(t,n){this.left=t,this.right=n}return r(n,t),n.prototype.renderLaTeX=function(){return this.left.renderLaTeX()+"^{"+this.right.renderLaTeX()+"}"},n.prototype.renderString=function(){return this.left.renderString()+"**"+this.bracketIfNeeded(this.right).renderString()},n.prototype.renderMathML=function(){return"<msup>"+this.left.renderMathML()+this.right.renderMathML()+"</msup>"},n}(e.DrawingNode),e.Bracket=function(t){function n(t){this.contents=t}return r(n,t),n.prototype.bindingStrength=function(){return 9},n.prototype.renderLaTeX=function(){return"\\left("+this.contents.renderLaTeX()+"\\right)"},n.prototype.renderString=function(){return"("+this.contents.renderString()+")"},n.prototype.renderMathML=function(){return"<mfenced><mrow>"+this.contents.renderMathML()+"</mrow></mfenced>"},n}(e.DrawingNode),e.Number=function(t){function n(t,n){this.value=t,this.classname=null!=n?n:"constant"}return r(n,t),n.prototype.bindingStrength=function(){return 10},n.prototype.renderLaTeX=function(){return this.value+""},n.prototype.renderString=function(){return this.value+""},n.prototype.renderMathML=function(){return'<mn class="'+this.classname+'">'+this.value+"</mn>"},n}(e.DrawingNode),e.Variable=function(n){function e(t,n){this.label=t,this.classname=null!=n?n:"variable"}return r(e,n),e.prototype.bindingStrength=function(){return 10},e.prototype.renderLaTeX=function(){var n,e,r,i,o;for(i="",o=this.label,e=0,r=o.length;r>e;e++)n=o[e],i+=n in t?t[n]:n;return i},e.prototype.renderString=function(){return this.label},e.prototype.renderMathML=function(){var t,n,e,r,i,o;for(o=this.label.split("-"),i=o[0],t=0;"@"===i[0];)t+=1,i=i.slice(1);return e='<mover accent="true">',n="<mrow><mo>"+function(){var n,e,i;for(i=[],r=n=0,e=t;e>=0?e>n:n>e;r=e>=0?++n:--n)i.push(".");return i}().join("")+"</mo></mrow></mover>",i.length>1?e+'<msub class="'+this.classname+'"><mi>'+i[0]+"</mi><mi>"+i.slice(1)+"</mi></msub>"+n:'<mi class="'+this.classname+'">'+i+"</mi>"},e}(e.DrawingNode),e.Fraction=function(t){function n(t,n){this.top=t,this.bottom=n}return r(n,t),n.prototype.bindingStrength=function(){return 8},n.prototype.renderLaTeX=function(){return"\\frac{"+this.top.renderLaTeX()+"}{"+this.bottom.renderLaTeX()+"}"},n.prototype.renderString=function(){return this.bracketIfNeeded(this.top).renderString()+"/"+this.bracketIfNeeded(this.bottom).renderString()},n.prototype.renderMathML=function(t,n){return"<mfrac> <mrow>"+this.top.renderMathML(t,n)+"</mrow> <mrow>"+this.bottom.renderMathML(t,n)+"</mrow> </mfrac>"},n}(e.DrawingNode),e.Surd=function(t){function e(t,n){this.contents=t,this.power=null!=n?n:null}return r(e,t),e.prototype.renderLaTeX=function(){return this.power&&2!==this.power?"\\sqrt["+this.power+"]{"+this.contents.renderLaTeX()+"}":"\\sqrt{"+this.contents.renderLaTeX()+"}"},e.prototype.renderString=function(){return this.power&&2!==this.power?this.bracketIfNeeded(this.contents).renderString()+" ** (1/"+this.power+")":"sqrt("+this.contents.renderString()+")"},e.prototype.renderMathML=function(){var t,e,r,i;return i=1<=arguments.length?n.call(arguments,0):[],this.power&&2!==this.power?"<mroot> <mrow> "+(t=this.power).renderMathML.apply(t,i)+" </mrow> <mrow> "+(e=this.contents).renderMathML.apply(e,i)+" </mrow> </mroot>":"<msqrt> "+(r=this.contents).renderMathML.apply(r,i)+" </msqrt>"},e}(e.DrawingNode),e.Negate=function(t){function e(t){this.contents=t}return r(e,t),e.prototype.renderLaTeX=function(){return"-\\left("+this.contents+"\\right)"},e.prototype.renderString=function(){return"-("+this.contents.renderString()+")"},e.prototype.renderMathML=function(){var t;return t=1<=arguments.length?n.call(arguments,0):[],"<mrow><mo>-</mo>"+this.contents.renderMathML()+"</mrow>"},e}(e.DrawingNode),e.Uncertainty=function(t){function e(t,n){this.label=t,this["class"]=null!=n?n:"default"}return r(e,t),e.prototype.bindingStrength=function(){return 9},e.prototype.renderLaTeX=function(){return"\\sigma_{"+this.label+"}"},e.prototype.renderString=function(){return"σ("+this.label+")"},e.prototype.renderMathML=function(){var t,e;return e=1<=arguments.length?n.call(arguments,0):[],t=new Variable(this.label),"<msub><mo>&sigma;</mo>"+t.renderMathML.apply(t,e)+"</msub>"},e}(e.DrawingNode),e})}.call(this),function(){var t;t={c:299792458,G:6.67384e-11,"π":Math.PI,PI:Math.PI,E:Math.E,e:Math.E,"ε0":8.85418782e-12,"μ0":125663706e-14,k:1.3806488e-23,h:6.62606957e-34,hbar:1.05457173e-34,NA:6.02214129e23,mu:1.66053892e-27,a0:5.29e-11,ke:1/(4*Math.PI*8.85418782e-12),ec:1.60217657e-19,R:8.3144621},e("constants",[],function(){return t})}.call(this),function(){var t=function(t,n){function e(){this.constructor=t}for(var i in n)r.call(n,i)&&(t[i]=n[i]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t},r={}.hasOwnProperty,i=[].indexOf||function(t){for(var n=0,e=this.length;e>n;n++)if(n in this&&this[n]===t)return n;return-1};e("terminals",["parse","nodes","prettyRender","constants"],function(e,r,o,l){var a,s,u,h,c;return u=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return t(e,n),e.prototype.copy=function(){throw new Error("Not implemented.")},e.prototype.containsVariable=function(t,n){return null==n&&(n={}),!1},e.prototype.approx=function(){return this.evaluate()},e}(r.BasicNode),a=function(e){function r(t,n,e){switch(this.numerator=t,this.denominator=null!=n?n:1,this.mode=null!=e?e:"rational",this.cmp=-6,("number"==typeof this.numerator||this.numerator instanceof Number)&&this.numerator%1!==0&&(this.mode="float"),this.mode){case"rational":this.numerator=parseInt(this.numerator),this.denominator=parseInt(this.denominator),this.simplifyInPlace();break;case"float":this.numerator=parseFloat(this.numerator),this.denominator=parseFloat(this.denominator),this.numerator/=this.denominator,this.denominator=1;break;default:throw new Error("Unknown constant mode: "+this.mode+".")}}return t(r,e),r.prototype.evaluate=function(){return this.numerator/this.denominator},r.prototype.copy=function(){return new r(this.numerator,this.denominator,this.mode)},r.prototype.compareSameType=function(t){return this.evaluate()<t.evaluate()?-1:this.evaluate()===t.evaluate()?0:1},r.prototype.mul=function(t){var n;return n=this.mode===t.mode?this.mode:"float",new r(this.numerator*t.numerator,this.denominator*t.denominator,n)},r.prototype.add=function(t){var n;return n=this.mode===t.mode?this.mode:"float",new r(t.denominator*this.numerator+this.denominator*t.numerator,this.denominator*t.denominator,n)},r.prototype.pow=function(t){var e,i,o,l,a;return"rational"===this.mode&&"rational"===t.mode?(o=!1,t.numerator<0&&t.denominator<0?t=new r(-t.numerator,-t.denominator):t.numerator>0&&t.denominator<0?(o=!0,t=new r(t.numerator,-t.denominator)):t.numerator<0&&t.denominator>0&&(o=!0,t=new r(-t.numerator,t.denominator)),l=Math.pow(this.numerator,t.numerator),i=Math.pow(this.denominator,t.numerator),e=o?new r(i,l,"rational"):new r(l,i,"rational"),1===t.denominator?e:(a=n("operators"),new a.Pow(e,new r(1,t.denominator,"rational")))):new r(Math.pow(this.evaluate(),t.evaluate()),1,"float")},r.prototype.equals=function(t){return t instanceof r?this.evaluate()===t.evaluate():!1},r.prototype.replaceVariables=function(){return this.copy()},r.prototype.getAllVariables=function(){return[]},r.prototype.sub=function(){return this.copy()},r.prototype.simplifyInPlace=function(){var t,n,e,r;for(t=this.numerator,n=this.denominator;0!==n;)r=[n,Math.round(t%n*10)/10],t=r[0],n=r[1];return e=t,this.numerator/=e,this.numerator=Math.round(10*this.numerator)/10,this.denominator/=e,this.denominator=Math.round(10*this.denominator)/10},r.prototype.simplify=function(){var t;return t=this.copy(),"rational"===this.mode&&t.simplifyInPlace(),t},r.prototype.expand=function(){return this.copy()},r.prototype.expandAndSimplify=function(){return this.simplify()},r.prototype.getUncertainty=function(){return new r(0)},r.prototype.mapOverVariables=function(){return this.copy()},r.prototype.toDrawingNode=function(){var t,n,e;return e=o.Number,t=o.Fraction,n=o.Negate,this.numerator>0?1===this.denominator?new e(this.numerator):new t(new e(this.numerator),new e(this.denominator)):new n(1===this.denominator?new e(-this.numerator):new t(new e(this.numerator),new e(this.denominator)))},r.prototype.differentiate=function(){return new r(0)},r}(u),s=function(n){function e(t,n,e){this.label=t,this.value=null!=n?n:null,this.units=null!=e?e:null,this.cmp=-5}return t(e,n),e.prototype.copy=function(){return new e(this.label,this.value,this.units)},e.prototype.compareSameType=function(t){return this.label<t.label?-1:this.label===t.label?0:1},e.prototype.evaluate=function(){return null!=this.value?this.value:this.label in l?l[this.label]:null},e.prototype.equals=function(t){return t instanceof e?this.label===t.label&&this.value===t.value:!1},e.prototype.replaceVariables=function(){return this.copy()},e.prototype.getAllVariables=function(){return[]},e.prototype.sub=function(t,n,e,r,i){return null==e&&(e=null),null==r&&(r=!1),null==i&&(i=!1),i?null!=this.value?new a(this.value,1,"float"):this.label in l?new a(l[this.label],1,"float"):this.copy():this.copy()},e.prototype.simplify=function(){return this.copy()},e.prototype.expand=function(){return this.copy()},e.prototype.expandAndSimplify=function(){return this.copy()},e.prototype.getUncertainty=function(){return new a(0)},e.prototype.mapOverVariables=function(){return this.copy()},e.prototype.toDrawingNode=function(){var t;return new(t=o.Variable)(this.label,"constant symbolic-constant")},e.prototype.differentiate=function(){return new a(0)},e}(u),c=function(n){function e(t,n){this.label=t,this.units=null!=n?n:null,this.cmp=-4}return t(e,n),e.prototype.copy=function(){return new e(this.label,this.units)},e.prototype.compareSameType=function(t){return this.label<t.label?-1:this.label===t.label?0:1},e.prototype.equals=function(t,n){var r;return null==n&&(n={}),t instanceof e?t.label in n?(r=this.label,i.call(n[t.label],r)>=0):t.label===this.label:!1},e.prototype.replaceVariables=function(t){var n;return n=this.copy(),this.label in t&&(n.label=t[this.label]),n},e.prototype.getAllVariables=function(){return[this.label]},e.prototype.sub=function(t,n,e){var r,i,o,l,s;null==e&&(e={}),r=this.label in e?e[this.label]:[this.label];for(i=0,l=r.length;l>i;i++)if(o=r[i],o in t)return s=t[o],null!=s.copy?s.copy():s%1===0?new a(s):new a(s,1,"float");return this.copy()},e.prototype.getUncertainty=function(){return new h(this.label)},e.prototype.mapOverVariables=function(t){return t(this.copy())},e.prototype.simplify=function(){return this.copy()},e.prototype.expand=function(){return this.copy()},e.prototype.expandAndSimplify=function(){return this.copy()},e.prototype.toDrawingNode=function(){var t;return new(t=o.Variable)(this.label)},e.prototype.differentiate=function(t,n){var e;return null==n&&(n={}),new a(t in n&&(e=this.label,i.call(n[t],e)>=0)?1:t===this.label?1:0)},e.prototype.evaluate=function(){return null},e.prototype.containsVariable=function(t,n){var e;return null==n&&(n={}),t in n?(e=this.label,i.call(n[t],e)>=0):t===this.label},e}(u),h=function(n){function e(t){this.label=t,this.cmp=-4.5}return t(e,n),e.prototype.copy=function(){return new e(this.label)},e.prototype.compareSameType=function(t){return this.label<t.label?-1:this.label===t.label?0:1},e.prototype.equals=function(t,n){var r;return null==n&&(n=null),t instanceof e?t.label in n?(r=this.label,i.call(n[t.label],r)>=0):t.label===this.label:!1},e.prototype.replaceVariables=function(t){var n;return n=this.copy(),this.label in t&&(n.label=t[this.label]),n},e.prototype.getAllVariables=function(){return[this.label]},e.prototype.sub=function(t,n,e,r){var i,o,l,s,u;if(null==e&&(e=null),null==r&&(r=!1),this.label in e){for(s=e[this.label],i=0,l=s.length;l>i;i++)if(o=s[i],o in n&&null!=n[o])return u=n[o],null!=u.copy?u.copy():new a(u);return r?new a("0"):this.copy()}return this.label in n&&null!=n[this.label]?(u=n[this.label],null!=u.copy?u.copy():new a(u)):r?new a("0"):this.copy()},e.prototype.getUncertainty=function(){throw new Error("Can't take uncertainty of an uncertainty")},e.prototype.mapOverVariables=function(){return this.copy()},e.prototype.simplify=function(){return this.copy()},e.prototype.expand=function(){return this.copy()},e.prototype.expandAndSimplify=function(){return this.copy()},e.prototype.toDrawingNode=function(){var t;return new(t=o.Uncertainty)(this.label)},e.prototype.differentiate=function(){throw new Error("Can't differentiate uncertainties!")},e}(u),{Terminal:u,Variable:c,Constant:a,SymbolicConstant:s,Uncertainty:h}})}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;e("AlgebraError",[],function(){var n;return n=function(n){function e(t,n,r){this.expr=t,this.variable=n,this.postscript=null!=r?r:null,e.__super__.constructor.call(this,"Unsolvable: "+this.expr+" for "+this.variable+(this.postscript?"; "+this.postscript:""))}return t(e,n),e.prototype.toString=function(){return"Unsolvable: "+this.expr+" for "+this.variable+(this.postscript?"; "+this.postscript:"")},e}(Error)})}.call(this),function(){var t=[].slice;e("parseArgs",["nodes","parse","terminals"],function(n,e,r){var i;return i=function(){var i,o,l,a,s;for(o=1<=arguments.length?t.call(arguments,0):[],s=[],l=0,a=o.length;a>l;l++)if(i=o[l],"string"==typeof i||i instanceof String)s.push(e.stringToTerminal(i));else if("number"==typeof i||i instanceof Number)s.push(new r.Constant(i));else{if(!(i instanceof r.Terminal||i instanceof n.BasicNode||null!=i.isTerminal))throw new Error("Invalid argument "+i+", ("+typeof i+"), ("+i.toString()+")");
s.push(i)}return s}})}.call(this),function(){e("compare",[],function(){var t;return t=function(t,n){return null!=t.cmp&&null!=n.cmp?t.cmp===n.cmp?t.compareSameType(n):(t.cmp-n.cmp)/Math.abs(t.cmp-n.cmp):0}})}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty,r=[].slice;e("operators/Add",["nodes","terminals","AlgebraError","parseArgs","require","compare","prettyRender"],function(n,e,i,o,l,a,s){var u,h,c;return h=function(t){var n,e,r,i,o,l,a,s,u;if(1===t.length)return function(){var e,r,i,o;for(i=t[0],o=[],e=0,r=i.length;r>e;e++)n=i[e],o.push(n);return o}();for(u=[],a=t[0],r=0,o=a.length;o>r;r++)for(n=a[r],s=h(t.slice(1)),i=0,l=s.length;l>i;i++)e=s[i],u.push([n].concat(e));return u},c=function(t,n,r){var i,o,a,s,u,h,c,p,f,y,d;for(null==r&&(r={}),i=l("operators/Mul"),s=[],u=0,c=t.length;c>u;u++)if(d=t[u],d instanceof e.Variable)s.push(new e.Constant("1"));else{for(y=[],f=d.children,h=0,p=f.length;p>h;h++)o=f[h],o.containsVariable(n,r)||y.push(o);a=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(i,y,function(){}),s.push(a)}return s},u=function(n){function u(){var t;if(t=1<=arguments.length?r.call(arguments,0):[],t.length<1)throw new Error("Add nodes must have at least one child.");this.cmp=-1,t=o.apply(null,t),u.__super__.constructor.call(this,"+",t)}return t(u,n),u.prototype.copy=function(){var t,n;return t=function(){var t,e,r,i;for(r=this.children,i=[],t=0,e=r.length;e>t;t++)n=r[t],i.push(null!=n.copy?n.copy():n);return i}.call(this),function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(u,t,function(){})},u.prototype.compareSameType=function(t){var n,e,r,i,o,l,s;for(l=this.children.length===t.children.length?0:this.children.length<t.children.length?-1:1,s=this.children,r=i=0,o=s.length;o>i;r=++i){if(e=s[r],null==t.children[r])return 1;if(n=a(this.children[r],t.children[r]),0!==n)return n}return l},u.prototype.mapOverVariables=function(t){var n,e,r,i,o;for(e=[],o=this.children,r=0,i=o.length;i>r;r++)n=o[r],e.push(n.mapOverVariables(t));return function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(u,e,function(){})},u.prototype.expand=function(){var t,n,e,r,i,o,l,a,s,h;for(r=[],s=this.children,i=0,l=s.length;l>i;i++)if(e=s[i],null!=e.expand?e=e.expand():null!=e.copy&&(e=e.copy()),e instanceof u)for(h=e.children,o=0,a=h.length;a>o;o++)n=h[o],r.push(n);else r.push(e);return t=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(u,r,function(){}),t.sort(),t},u.prototype.sort=function(){var t,n,e,r;for(r=this.children,n=0,e=r.length;e>n;n++)t=r[n],"function"==typeof t.sort&&t.sort();return this.children.sort(a)},u.prototype.equals=function(t,n){var e,r,i,o,l;if(null==n&&(n={}),!(t instanceof u))return!1;if(t.children.length!==this.children.length)return!1;for(l=this.children,r=i=0,o=l.length;o>i;r=++i)if(e=l[r],null!=e.equals){if(!e.equals(t.children[r],n))return!1}else if(e!==t.children[r])return!1;return!0},u.prototype.simplify=function(t){var n,r,i,o,a,s,h,c,p,f,y,d,g,m,w,b,v,x,_,S,A,M,V,k,N,C,E,O,L,P,T;for(null==t&&(t={}),n=l("operators/Mul"),P=[],C=this.children,f=0,g=C.length;g>f;f++)o=C[f],null!=o.simplify?o=o.simplify(t):null!=o.copy&&(o=o.copy()),P.push(o);for(S=[],a=null,c=0;c<P.length;){if(L=P[c],L instanceof u){for(P.splice(c,1)[0],E=L.children,y=0,m=E.length;m>y;y++)i=E[y],P.push(i);c-=1}else if(L instanceof e.Constant)a=null!=a?a.add(L):L.copy();else if(L instanceof n){for(s=null,T=null,O=L.children,d=0,w=O.length;w>d;d++)o=O[d],o instanceof e.Constant?s=null!=s?s.multiply(o):o.copy():null!=T?T.children.push(o):T=new n(o);if(1===T.children.length&&(T=T.children[0]),null!=s&&null==T)a=null!=a?a.add(s):s.copy();else{for(null==s&&(s=new e.Constant("1")),h=!1,p=A=0,b=S.length;b>A;p=++A)_=S[p],null!=_[0].equals?_[0].equals(T,t)&&(S[p][1]=new u(_[1],s),S[p][1]=S[p][1].simplify(t),h=!0):_[0]===T&&(S[p][1]=new u(_[1],s),S[p][1]=S[p][1].simplify(t),h=!0);h||S.push([T,s])}}else{for(h=!1,p=M=0,v=S.length;v>M;p=++M)_=S[p],null!=_[0].equals?_[0].equals(L,t)&&(S[p][1]=new u(_[1],new e.Constant("1")),S[p][1]=S[p][1].simplify(t),h=!0):_[0]===L&&(S[p][1]=new u(_[1],new e.Constant("1")),S[p][1]=S[p][1].simplify(t),h=!0);h||S.push([L,new e.Constant("1")])}c+=1}for(V=null,N=0,x=S.length;x>N;N++)_=S[N],null!=_[0].children&&1===_[0].children.length&&(_[0]=_[0].children[0]),1!==("function"==typeof(r=_[1]).evaluate?r.evaluate():void 0)?(k=new n(_[0],_[1]),k=k.simplify(t)):k=_[0],null!=V?V.children.push(k):V=new u(k);return null==V?a:(null!=a&&0!==a.evaluate()&&V.children.push(a),V.sort(),1!==V.children.length?V:V.children[0])},u.prototype.expandAndSimplify=function(t){var n;return null==t&&(t={}),n=this.expand(),null!=n.simplify?n.simplify(t):n},u.prototype.solve=function(t,n){var r,o,a,s,h,p,f,y,d,g,m,w,b,v,x,_,S,A,M,V,k,N,C,E,O,L,P,T,q,j,I,D,X,U,$;if(null==n&&(n={}),r=l("operators/Mul"),o=l("operators/Pow"),g=this.expandAndSimplify(n).expandAndSimplify(n),!(g instanceof u)){if(!g.containsVariable(t,n))throw new i(g.toString(),t,"(variable not found)");return g.solve(t,n)}for(f=[],w=[],j=g.children,b=0,S=j.length;S>b;b++)$=j[b],$.containsVariable(t,n)?f.push($.copy()):w.push($.copy());if(0===f.length)throw new i(g.toString(),t,"(variable not found)");for(k=[],P=[],O=[],v=0,A=f.length;A>v;v++)$=f[v],$ instanceof e.Variable?k.push($):$ instanceof r&&$.isLinear(t,n)?k.push($):$ instanceof o&&$.containsVariable(t,n)&&!$.children.right.containsVariable(t,n)?P.push($):$ instanceof r&&$.isPolynomial(t,n)?P.push($):O.push($);if(O.length>0)throw new i(g.toString(),t,"(can't solve non-polynomial equations yet)");if(0===P.length)return E=new r("-1",function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(u,w,function(){})),m=c(k,t,n),q=new o(function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(u,m,function(){}),"-1"),U=new r(E,q),[U.expandAndSimplify(n)];for(X=null,L=[],x=0,M=P.length;M>x;x++)if($=P[x],$ instanceof o)if(null==X)X=$.children.right,L.push(new e.Constant("1"));else{if(!X.equals($.children.right,n))throw new i(g.toString(),t,"(can't solve polynomials of degree > 2 yet)");L.push(new e.Constant("1"))}else{for(C=[],I=$.children,N=0,V=I.length;V>N;N++)if(p=I[N],p instanceof o&&p.containsVariable(t,n))if(null==X)X=p.children.right,C.push(new e.Constant("1"));else{if(!X.equals(p.children.right,n))throw new i(g.toString(),t,"(can't solve polynomials of degree > 2 yet)");C.push(new e.Constant("1"))}else C.push(p);L.push(function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(r,C,function(){}))}if(k.length>0&&2!==X.evaluate())throw new i(g.toString(),t,"(can't solve polynomials of degree > 2 yet)");return k.length>0?(a=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(u,L,function(){}),s=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(u,c(k,t,n),function(){}),h=w.length?function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(u,w,function(){}):new e.Constant("0"),y=new o(new u(new o(s.copy(),"2"),new r("-4",a.copy(),h)),new o("2","-1")),d=new r(y,new o(new r("2",a),"-1")),_=new r("-1",s,new o(new r("2",a),"-1")),[new u(_.copy(),d.copy()).expandAndSimplify(),new u(_,new r("-1",d)).expandAndSimplify()]):(E=w.length?new r("-1",function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(u,w,function(){})):new e.Constant("0"),q=L.length?new o(function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(u,L,function(){}),"-1"):new e.Constant("1"),T=new r(E,q),D=new o(X,"-1"),U=new o(T,D),("function"==typeof X.evaluate?X.evaluate(n):void 0)&&X.evaluate(n)%2===0?[U.expandAndSimplify(n),new r("-1",U).expandAndSimplify(n)]:[U.expandAndSimplify(n)])},u.prototype.getAllVariables=function(){var t,n,r,i,o,l,a,s,u,h;for(h={},s=this.children,r=0,o=s.length;o>r;r++)if(t=s[r],t instanceof e.Variable)h[t.label]=!0;else if(null!=t.getAllVariables)for(n=t.getAllVariables(),i=0,l=n.length;l>i;i++)u=n[i],h[u]=!0;a=[];for(u in h)a.push(u);return a},u.prototype.replaceVariables=function(t){var n,r,i,o,l,a;for(r=[],a=this.children,i=o=0,l=a.length;l>o;i=++o)n=a[i],n instanceof e.Variable&&n.label in t?(r.push(n.copy()),r[i].label=t[n.label]):r.push(null!=n.replaceVariables?n.replaceVariables(t):n.copy());return function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(u,r,function(){})},u.prototype.sub=function(t,n,r,i,o){var l,a,s,h,c,p,f,y,d,g,m,w;null==r&&(r={}),null==i&&(i=!1),null==o&&(o=!1);for(m in t)null==t[m].copy&&(t[m]=new e.Constant(t[m]));for(a=[],d=this.children,h=0,p=d.length;p>h;h++)if(l=d[h],l instanceof e.Variable){w=l.label in r?r[l.label]:[l.label],g=!1;for(c=0,f=w.length;f>c;c++)if(s=w[c],s in t){a.push(t[s].copy()),g=!0;break}g||a.push(l.copy())}else a.push(null!=l.sub?l.sub(t,n,r,i,o):l.copy());return y=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(u,a,function(){}),y=y.expandAndSimplify(r)},u.prototype.toDrawingNode=function(){var t;return t=s.Add,t.makeWithBrackets.apply(t,this.children.map(function(t){return t.toDrawingNode()}))},u.prototype.differentiate=function(t,n){var e,r;return null==n&&(n={}),r=this.children.map(function(e){return e.differentiate(t,n)}),e=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(u,r,function(){}),e.expandAndSimplify(n)},u.prototype.containsVariable=function(t,n){var e,r,i,o;for(null==n&&(n={}),o=this.children,r=0,i=o.length;i>r;r++)if(e=o[r],e.containsVariable(t,n))return!0;return!1},u.approx=function(t,n){return t+n},u}(n.RoseNode)})}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty,r=[].slice,i=[].indexOf||function(t){for(var n=0,e=this.length;e>n;n++)if(n in this&&this[n]===t)return n;return-1};e("operators/Mul",["nodes","terminals","AlgebraError","parseArgs","require","compare","prettyRender"],function(n,e,o,l,a,s,u){var h,c;return c=function(t){var n,e,r,i,o,l,a,s,u;if(1===t.length)return function(){var e,r,i,o;for(i=t[0],o=[],e=0,r=i.length;r>e;e++)n=i[e],o.push(n);return o}();for(u=[],a=t[0],r=0,o=a.length;o>r;r++)for(n=a[r],s=c(t.slice(1)),i=0,l=s.length;l>i;i++)e=s[i],u.push([n].concat(e));return u},h=function(n){function h(){var t;if(t=1<=arguments.length?r.call(arguments,0):[],t.length<1)throw new Error("Mul nodes must have at least one child.");this.cmp=-2,t=l.apply(null,t),h.__super__.constructor.call(this,"*",t)}return t(h,n),h.prototype.copy=function(){var t,n;return t=function(){var t,e,r,i;for(r=this.children,i=[],t=0,e=r.length;e>t;t++)n=r[t],i.push(null!=n.copy?n.copy():n);return i}.call(this),function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(h,t,function(){})},h.prototype.simplifyConstants=function(){var t,n,r,i,o,l;for(n=new e.Constant("1"),l=null,o=this.children,r=0,i=o.length;i>r;r++)t=o[r],t instanceof e.Constant?n=n.mul(t):null!=l?l.children.push(t):l=new h(t);return null==l?n:1===n.evaluate()?l:new h(n,l)},h.prototype.compareSameType=function(t){var n,e,r,i,o,l,a;for(l=this.children.length===t.children.length?0:this.children.length<t.children.length?-1:1,a=this.children,r=i=0,o=a.length;o>i;r=++i){if(e=a[r],null==t.children[r])return 1;if(n=s(this.children[r],t.children[r]),0!==n)return n}return l},h.prototype.mapOverVariables=function(t){var n,e,r,i,o;for(e=[],o=this.children,r=0,i=o.length;i>r;r++)n=o[r],e.push(n.mapOverVariables(t));return function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(h,e,function(){})},h.expandMulAdd=function(t,n){var e,r,i,o,l,s,u,c,p,f,y,d;for(e=a("operators/Add"),d=[],f=n.children,o=0,s=f.length;s>o;o++){if(i=f[o],null!=i.copy&&(i=i.copy()),i instanceof h)for(p=t.copy(),y=i.children,l=0,u=y.length;u>l;l++)r=y[l],p.children.push(r);else i instanceof e?p=h.expandMulAdd(t,i):1===t.children.length?(p=t.copy(),p.children.push(i.copy())):p=new h(t.copy(),i.copy());d.push(p)}return c=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(e,d,function(){}),c=c.expand()},h.prototype.equals=function(t,n){var e,r,i,o,l;if(null==n&&(n={}),!(t instanceof h))return!1;if(t.children.length!==this.children.length)return!1;for(l=this.children,r=i=0,o=l.length;o>i;r=++i)if(e=l[r],null!=e.equals){if(!e.equals(t.children[r],n))return!1}else if(e!==t.children[r])return!1;return!0},h.prototype.expand=function(){var t,n,e,r,i,o,l,s,u,c,p,f,y,d,g;for(t=a("operators/Add"),g=[],p=this.children,r=0,l=p.length;l>r;r++)e=p[r],null!=e.expand?e=e.expand():null!=e.copy&&(e=e.copy()),g.push(e);for(;g.length>1;)if(g[0]instanceof h)if(g[1]instanceof t)g[0]=h.expandMulAdd(g[0],g.splice(1,1)[0]);else if(g[1]instanceof h)for(f=g.splice(1,1)[0].children,i=0,s=f.length;s>i;i++)e=f[i],g[0].children.push(e);else g[0].children.push(g.splice(1,1)[0]);else if(g[0]instanceof t)if(g[1]instanceof t){for(d=[],y=g[0].children,o=0,u=y.length;u>o;o++)e=y[o],c=new h(e,g[1]),c=c.expand(),d.push(c);g.splice(1,1),g[0]=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(t,d,function(){}),g[0]=g[0].expand()}else g[0]=g[1]instanceof h?h.expandMulAdd(g.splice(1,1)[0],g[0]):new h(g[0],g.splice(1,1)[0]);else g[0]=new h(g[0]);return"function"==typeof(n=g[0]).sort&&n.sort(),g[0]},h.prototype.simplify=function(t){var n,r,i,o,l,s,u,c,p,f,y,d,g,m,w,b,v,x,_,S,A,M,V,k,N,C,E,O,L,P,T,q,j,I,D,X,U,$,B,F,R,z,Z,W,G,Q,K,Y;for(null==t&&(t={}),n=a("operators/Add"),r=a("operators/Pow"),Y=[],$=this.children,g=0,b=$.length;b>g;g++)c=$[g],null!=c.simplify?c=c.simplify(t):null!=c.copy&&(c=c.copy()),Y.push(c);for(N=[],p=null,y=0;y<Y.length;){if(G=Y[y],G instanceof h){for(c=Y.splice(y,1)[0],B=c.children,m=0,v=B.length;v>m;m++)u=B[m],Y.push(u);y-=1}else if(G instanceof e.Constant)p=null!=p?p.mul(G):G.copy();else if(G instanceof r){for(i=G.children.left,I=G.children.right,f=!1,d=w=0,x=N.length;x>w;d=++w)k=N[d],null!=k[0].equals?k[0].equals(i,t)&&(N[d][1]=new n(k[1],I),N[d][1]=N[d][1].simplify(t),1===(null!=(F=N[d][1].children)?F.length:void 0)&&(N[d][1]=N[d][1].children[0]),f=!0):k[0]===i&&(N[d][1]=new n(k[1],I),N[d][1]=N[d][1].simplify(t),1===(null!=(R=N[d][1].children)?R.length:void 0)&&(N[d][1]=N[d][1].children[0]),f=!0);f||N.push([i,I])}else{for(f=!1,d=C=0,_=N.length;_>C;d=++C)k=N[d],null!=k[0].equals?k[0].equals(G,t)&&(N[d][1]=new n(k[1],new e.Constant("1")),N[d][1]=N[d][1].simplify(t),1===(null!=(z=N[d][1].children)?z.length:void 0)&&(N[d][1]=N[d][1].children[0]),f=!0):k[0]===G&&(N[d][1]=new n(k[1],new e.Constant("1")),N[d][1]=N[d][1].simplify(t),1===(null!=(Z=N[d][1].children)?Z.length:void 0)&&(N[d][1]=N[d][1].children[0]),f=!0);f||N.push([G,new e.Constant("1")])}y+=1}if(0===(null!=p&&"function"==typeof p.evaluate?p.evaluate():void 0))return new e.Constant("0");for(O=[],E=0,S=N.length;S>E;E++){if(Q=N[E],o=Q[0],D=Q[1],f=!1,1!==("function"==typeof D.evaluate?D.evaluate():void 0))for(q=0,A=O.length;A>q;q++)if(K=O[q],l=K[0],X=K[1],"function"==typeof X.equals?X.equals(D,t):void 0){l.push(o),f=!0;break}f||O.push([[o],D])}for(N=function(){var t,n,e,r;for(r=[],n=0,t=O.length;t>n;n++)e=O[n],i=e[0],I=e[1],r.push([(1===i.length?i[0]:function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(h,i,function(){})).expandAndSimplify(),I]);return r}(),L=null,j=0,M=N.length;M>j;j++)k=N[j],1!==("function"==typeof(s=k[1]).evaluate?s.evaluate():void 0)?(P=new r(k[0],k[1]),P=P.simplify(t)):P=k[0],null!=L?L.children.push(P):L=new h(P);if(null==L)return p;for(null!=p&&1!==p.evaluate()&&L.children.push(p),L.sort(),T=!0,W=L.children,U=0,V=W.length;V>U;U++)if(c=W[U],!(c instanceof e.Constant)){T=!1;break}return T?L.simplifyConstants():1!==L.children.length?L:L.children[0]},h.prototype.sort=function(){var t,n,e,r;for(r=this.children,n=0,e=r.length;e>n;n++)t=r[n],"function"==typeof t.sort&&t.sort();return this.children.sort(s)},h.prototype.expandAndSimplify=function(t){var n;return null==t&&(t={}),n=this.expand(),null!=n.simplify?n.simplify(t):n},h.prototype.solve=function(t,n){var r,l,s,u,c,p,f,y,d;if(null==n&&(n={}),r=a("operators/Pow"),u=this.expandAndSimplify(n),u instanceof e.Terminal){if(u instanceof e.Variable&&(u.label===t||t in n&&(f=u.label,i.call(n[t],f)>=0)))return[new e.Constant("0")];throw new o(u.toString(),t)}if(!(u instanceof h))return u.solve(t,n);for(y=u.children,c=0,p=y.length;p>c;c++){if(l=y[c],l instanceof e.Variable&&(l.label===t||t in n&&(d=l.label,i.call(n[t],d)>=0)))return[new e.Constant("0")];if(l instanceof r)try{return l.solve(t,n)}catch(g){if(s=g,s instanceof o)continue;throw s}}throw new o(u.toString(),t)},h.prototype.getAllVariables=function(){var t,n,r,i,o,l,a,s,u,h;for(h={},s=this.children,r=0,o=s.length;o>r;r++)if(t=s[r],t instanceof e.Variable)h[t.label]=!0;else if(null!=t.getAllVariables)for(n=t.getAllVariables(),i=0,l=n.length;l>i;i++)u=n[i],h[u]=!0;a=[];for(u in h)a.push(u);return a},h.prototype.replaceVariables=function(t){var n,r,i,o,l,a;for(r=[],a=this.children,i=o=0,l=a.length;l>o;i=++o)n=a[i],n instanceof e.Variable&&n.label in t?(r.push(n.copy()),r[i].label=t[n.label]):r.push(null!=n.replaceVariables?n.replaceVariables(t):n.copy());return function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(h,r,function(){})},h.prototype.sub=function(t,n,r,i,o){var l,a,s,u,c,p,f,y,d,g,m,w;null==r&&(r={}),null==i&&(i=!1),null==o&&(o=!1);for(m in t)null==t[m].copy&&(t[m]=new e.Constant(t[m]));for(a=[],d=this.children,u=0,p=d.length;p>u;u++)if(l=d[u],l instanceof e.Variable){w=l.label in r?r[l.label]:[l.label],g=!1;for(c=0,f=w.length;f>c;c++)if(s=w[c],s in t){a.push(t[s].copy()),g=!0;break}g||a.push(l.copy())}else a.push(null!=l.sub?l.sub(t,n,r,i,o):l.copy());return y=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(h,a,function(){}),y=y.expandAndSimplify(r)},h.prototype.toDrawingNode=function(){var t,n,r,i,o,l,s,c,p,f,y,d,g,m;if(t=a("operators/Pow"),e=a("terminals"),this.children[0]instanceof e.Constant&&this.children[0].numerator<0)return p=this.children.slice(0),p[0]=new e.Constant(-1*this.children[0].numerator,this.children[0].denominator),l=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(h,p,function(){}),new u.Negate(l.toDrawingNode());for(m=[],n=[],y=this.children,i=0,o=y.length;o>i;i++)r=y[i],r instanceof t?(f=r.children.right,f instanceof e.Constant?(f.denominator<0&&(f.denominator*=-1,f.numerator*=-1),f.numerator<0?n.push(new t(r.children.left,new e.Constant(f.numerator,-f.denominator)).toDrawingNode()):m.push(r.toDrawingNode())):m.push(r.toDrawingNode())):r instanceof e.Constant?(1!==r.numerator&&m.unshift(new u.Number(r.numerator)),1!==r.denominator&&n.unshift(new u.Number(r.denominator))):m.push(r.toDrawingNode());return 1===n.length?c=n[0]:n.length>1&&(c=(d=u.Mul).makeWithBrackets.apply(d,n)),s=!1,m.length>=1&&m[0]instanceof e.Constant&&m[0].numerator<0&&(m[0].numerator*=-1,s=!0),1===m.length?m=m[0]:m.length>1&&(m=(g=u.Mul).makeWithBrackets.apply(g,m)),0===n.length?m:0===m.length?new u.Fraction(new u.Number(1),c):new u.Fraction(m,c)},h.prototype.differentiate=function(t,n){var e,r,i;if(null==n&&(n={}),e=a("operators/Add"),0===this.children.length)throw new Error("I'm pretty sure you need children in your Mul node");return 1===this.children.length?this.children[0].differentiate(t,n).expandAndSimplify(n):(r=this.children[0],i=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(h,this.children.slice(1),function(){}),new e(new h(r,i.differentiate(t,n)),new h(i,r.differentiate(t,n))).expandAndSimplify(n))},h.prototype.containsVariable=function(t,n){var e,r,i,o;for(null==n&&(n={}),o=this.children,r=0,i=o.length;i>r;r++)if(e=o[r],e.containsVariable(t,n))return!0;return!1},h.prototype.isLinear=function(t,n){var r,i,o,l,a,s,u;if(null==n&&(n={}),i=0,u=0,o=this.expandAndSimplify(n),!(o instanceof h))return!1;for(s=o.children,l=0,a=s.length;a>l;l++)r=s[l],r instanceof e.Variable?r.containsVariable(t,n)&&(u+=1):r.containsVariable(t,n)&&(i+=1);return i>0?!1:u>1?!1:!0},h.prototype.isPolynomial=function(t,n){var r,i,o,l,s,u,c,p,f;if(null==n&&(n={}),r=a("operators/Pow"),f=0,c=0,o=0,l=this.expandAndSimplify(n),!(l instanceof h))return!1;for(p=l.children,s=0,u=p.length;u>s;s++)i=p[s],i instanceof e.Variable&&i.containsVariable(t,n)?f+=1:i instanceof r&&i.containsVariable(t,n)&&!i.children.right.containsVariable(t,n)?c+=1:i.containsVariable(t,n)&&(o+=1);return o>0?!1:f>0?c>0?!1:!0:c>1?!1:!0},h.approx=function(t,n){return t*n},h}(n.RoseNode)})}.call(this),function(){var t=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty,r=[].slice,i=[].indexOf||function(t){for(var n=0,e=this.length;e>n;n++)if(n in this&&this[n]===t)return n;return-1};e("operators/Pow",["nodes","terminals","AlgebraError","parseArgs","require","compare","prettyRender"],function(n,e,o,l,a,s,u){var h;return h=function(n){function h(){var t,n,e,i;if(n=arguments[0],e=arguments[1],t=3<=arguments.length?r.call(arguments,2):[],null==n||null==e)throw new Error("Pow nodes must have two children.");if(t.length>0)throw new Error("Pow nodes must have two children.");this.cmp=-3,i=l(n,e),n=i[0],e=i[1],h.__super__.constructor.call(this,"**",n,e)}return t(h,n),h.prototype.copy=function(){return new h(null!=this.children.left.copy?this.children.left.copy():this.children.left,null!=this.children.right.copy?this.children.right.copy():this.children.right)},h.prototype.sort=function(){var t,n;return"function"==typeof(t=this.children.left).sort&&t.sort(),"function"==typeof(n=this.children.right).sort?n.sort():void 0},h.prototype.equals=function(t,n){if(null==n&&(n={}),!(t instanceof h))return!1;if(null!=this.children.left.equals){if(!this.children.left.equals(t.children.left,n))return!1}else if(this.children.left!==t.children.left)return!1;if(null!=this.children.right.equals){if(!this.children.right.equals(t.children.right,n))return!1}else if(this.children.right!==t.children.right)return!1;return!0},h.prototype.compareSameType=function(t){var n;return n=s(this.children.left,t.children.left),0!==n?n:s(this.children.right,t.children.right)},h.prototype.mapOverVariables=function(t){var n,e;return n=this.children.left.mapOverVariables(t),e=this.children.right.mapOverVariables(t),new h(n,e)},h.prototype.expand=function(){var t,n,r,i,o,l,s,u,c,p,f,y,d,g,m;if(n=a("operators/Mul"),t=a("operators/Add"),c=null!=this.children.left.expand?this.children.left.expand():null!=this.children.left.copy?this.children.left.copy():this.children.left,m=null!=this.children.right.expand?this.children.right.expand():null!=this.children.right.copy?this.children.right.copy():this.children.right,null!=c.children){if(c instanceof h)c.children.right=new n(c.children.right,m),c.expand();else if(c instanceof n)for(d=c.children,l=s=0,p=d.length;p>s;l=++s)r=d[l],y=new h(r,m),y=y.expand(),c.children[l]=y;else if(c instanceof t)if(m instanceof e.Constant&&m.evaluate()%1===0&&m.evaluate()>0){for(i=[],o=u=1,g=m.evaluate();g>=1?g>=u:u>=g;o=g>=1?++u:--u)i.push(c);f=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(n,i,function(){}),f=f.expand(),c=f}else c=new h(c,m);return c}return new h(c,m)},h.prototype.simplify=function(t){var n,r,i,o,l;return null==t&&(t={}),n=a("operators/Mul"),r=null!=this.children.left.simplify?this.children.left.simplify(t):null!=this.children.left.copy?this.children.left.copy():this.children.left,l=null!=this.children.right.simplify?this.children.right.simplify(t):null!=this.children.right.copy?this.children.right.copy():this.children.right,1===("function"==typeof l.evaluate?l.evaluate():void 0)?r:1===("function"==typeof r.evaluate?r.evaluate():void 0)||0===("function"==typeof r.evaluate?r.evaluate():void 0)?r:0===("function"==typeof l.evaluate?l.evaluate():void 0)?new e.Constant("1"):l instanceof e.Constant&&r instanceof e.Constant?r.pow(l):r instanceof h?(o=new n(r.children.right,l),i=new h(r.children.left,o),i=i.simplify(t)):new h(r,l)},h.prototype.expandAndSimplify=function(t){var n;return null==t&&(t={}),n=this.expand(),null!=n.simplify?n.simplify(t):n},h.prototype.solve=function(t,n){var r,l,s,u,c,p,f,y,d;if(null==n&&(n={}),r=a("operators/Mul"),s=this.expandAndSimplify(n),s instanceof e.Terminal){if(s instanceof e.Variable&&(s.label===t||s.label in n&&i.call(n[s.label],t)>=0))return[new e.Constant("0")];throw new o(s.toString(),t)}if(s instanceof h){if(s.children.left instanceof e.Variable){if(s.children.left.label===t||s.children.left.label in n&&i.call(n[s.children.left.label],t)>=0)return[new e.Constant("0")];throw new o(s.toString(),t)}if(s.children.left instanceof e.Terminal)throw new o(s.toString(),t);try{d=s.children.left.solve(t,n)}catch(g){throw l=g}if(null!=s.children.right.evaluate&&s.children.right.evaluate()%2===0){for(f=[],u=0,c=d.length;c>u;u++)y=d[u],p=new r(-1,y).simplify(n),null!=p.equals?(p.equals(y)||f.push(p),f.push(y)):(p!==y&&f.push(p),f.push(y));return f}return d}return s.solve(t,n)},h.prototype.sub=function(t,n,r,i,o){var l,a,s,u,c,p,f,y,d,g,m;null==r&&(r={}),null==i&&(i=!1),null==o&&(o=!1);for(g in t)null==t[g].copy&&(t[g]=t[g]%1===0?new e.Constant(t[g]):new e.Constant(t[g],1,"float"));if(u=null,y=null,this.children.left instanceof e.Variable){m=this.children.left.label in r?r[this.children.left.label]:[this.children.left.label];for(a=0,c=m.length;c>a;a++)if(l=m[a],l in t){u=t[l].copy();break}null==u&&(u=this.children.left.copy())}else u=null!=this.children.left.sub?this.children.left.sub(t,n,r,i,o):this.children.left.copy();if(this.children.right instanceof e.Variable){m=this.children.right.label in r?r[this.children.right.label]:[this.children.right.label],d=!1;for(s=0,p=m.length;p>s;s++)if(l=m[s],l in t){y=t[l].copy(),d=!0;break}d||(y=this.children.right.copy())}else y=null!=this.children.right.sub?this.children.right.sub(t,n,r,i,o):this.children.right.copy();return f=new h(u,y),f=f.expandAndSimplify(r)},h.prototype.getAllVariables=function(){var t,n,r,i,o,l,a,s,u;if(u={},this.children.left instanceof e.Variable)u[this.children.left.label]=!0;else if(null!=this.children.left.getAllVariables)for(r=this.children.left.getAllVariables(),t=0,i=r.length;i>t;t++)s=r[t],u[s]=!0;if(this.children.right instanceof e.Variable)u[this.children.right.label]=!0;else if(null!=this.children.right.getAllVariables)for(a=this.children.right.getAllVariables(),n=0,o=a.length;o>n;n++)s=a[n],u[s]=!0;l=[];for(s in u)l.push(s);return l},h.prototype.replaceVariables=function(t){var n,r;return n=this.children.left.copy(),r=this.children.right.copy(),n instanceof e.Variable&&n.label in t?n.label=t[n.label]:null!=n.replaceVariables&&(n=n.replaceVariables(t)),r instanceof e.Variable&&r.label in t?r.label=t[r.label]:null!=r.replaceVariables&&(r=r.replaceVariables(t)),new h(n,r)},h.prototype.toDrawingNode=function(){var t,n,r,i;return i=null!=u?u.Surd:void 0,r=u.Pow,t=u.Fraction,n=u.Number,this.children.right instanceof e.Constant&&1===this.children.right.numerator?1===this.children.right.denominator?this.children.left.toDrawingNode():this.children.right.denominator>0?new i(this.children.left.toDrawingNode(),this.children.right.denominator):new t(new n(1),new i(this.children.left.toDrawingNode(),-this.children.right.denominator)):new r(r.prototype.bracketIfNeeded(this.children.left.toDrawingNode()),this.children.right.toDrawingNode())},h.prototype.differentiate=function(t,n){var e,r,o,l;if(null==n&&(n={}),e=a("operators/Add"),o=a("operators/Mul"),r=a("terminals").Constant,i.call(this.children.right.getAllVariables,t)>=0)throw new Error("I can't differentiate with a variable on the top of a power");return 0===("function"==typeof(l=this.children.right).evaluate?l.evaluate():void 0)?new r(0):new o(new h(this.children.left,new e(this.children.right,new r(-1))),this.children.left.differentiate(t,n),this.children.right).expandAndSimplify(n)},h.prototype.containsVariable=function(t,n){return null==n&&(n={}),this.children.left.containsVariable(t,n)||this.children.right.containsVariable(t,n)},h.approx=function(t,n){return Math.pow(t,n)},h}(n.BinaryNode)})}.call(this),function(){e("operators",["operators/Add","operators/Mul","operators/Pow"],function(t,n,e){return{Add:t,Mul:n,Pow:e}})}.call(this),function(){var t=[].slice;e("Expression",["parse","nodes"],function(n){var e;return e=function(){function e(t){if(t instanceof String||"string"==typeof t)this.expr=n.stringToExpression(t),null!=this.expr.simplify&&(this.expr=this.expr.simplify());else{if(null==t.copy)throw console.log("Received argument: ",t),new Error("Unknown argument: `"+t+"'.");this.expr=t.copy().simplify()}}return e.prototype.toString=function(){return this.expr.toString()},e.prototype.toMathML=function(){return this.expr.toMathML()},e.prototype.toLaTeX=function(){return this.expr.toLaTeX()},e.prototype.solve=function(t,n){var r,i,o,l,a;for(null==n&&(n={}),o=this.expr.solve(t,n),l=[],r=0,i=o.length;i>r;r++)a=o[r],l.push(new e(a));return l},e.prototype.sub=function(t,n,r,i){var o,l,a,s,u;null==n&&(n={}),null==r&&(r=!1),null==i&&(i=!1),l={};for(o in t)l[o]=t[o]instanceof e?t[o].expr:t[o];return r?(s=l,u={}):(s={},u=l),a=this.expr.sub(u,s,n,!1,i),null!=a.simplify&&(a=a.simplify(n)),new e(a)},e.prototype.getAllVariables=function(){return this.expr.getAllVariables()},e.prototype.mapOverVariables=function(t){return this.expr.mapOverVariables(t)},e.prototype.copy=function(){return new e(this.expr.copy())},e.prototype.simplify=function(t){var n;return null==t&&(t={}),n=null!=this.expr.expandAndSimplify?this.expr.expandAndSimplify(t):null!=this.expr.simplify?this.expr.simplify(t):this.expr.copy(),new e(n)},e.prototype.expand=function(){var t;return t=null!=this.expr.expand?this.expr.expand():this.expr.copy(),new e(t)},e.prototype.differentiate=function(t,n){return null==n&&(n={}),new e(this.expr.differentiate(t,n))},e.prototype.getUncertainty=function(){return new e(this.expr.getUncertainty())},e.prototype.toFunction=function(){var n,e,r,i;return i=2<=arguments.length?t.call(arguments,0,r=arguments.length-1):(r=0,[]),n=arguments[r++],("string"==typeof n||n instanceof String)&&(i.push(n),n={}),e=function(e){return function(){var r,o,l,a,s,u;for(a=1<=arguments.length?t.call(arguments,0):[],s={},r=o=0,l=i.length;l>o;r=++o)u=i[r],null!=a[r]&&(s[u]=a[r]);return e.sub(s,n)}}(this)},e.prototype.approx=function(){return this.expr.approx()},e.prototype.equals=function(t){var n,r;return t instanceof e?(n=this.expr.expandAndSimplify(),r=t.expr.expandAndSimplify(),n.equals(r)):void 0},e}()})}.call(this),function(){e("uncertainties",["nodes","terminals","operators","require"],function(t,n,e){return t.BasicNode.prototype.getUncertainty=function(){var t,r,i,o,l,a,s,u,h,c,p;for(i=e.Mul,o=e.Pow,t=e.Add,l=n.Uncertainty,r=n.Constant,p=this.getAllVariables(),u=[],a=0,s=p.length;s>a;a++)c=p[a],h=new i(new n.Uncertainty(c),this.differentiate(c)),u.push(new o(h,2));return new o(function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(t,u,function(){}),new n.Constant(1,2)).expandAndSimplify()}})}.call(this),function(){n.config({baseUrl:"./"}),e("coffeequate",["operators","Expression","parse","uncertainties","terminals"],function(t,n,e,r,i){var o;return o=function(r){var i,o,l,a;return/\=/.test(r)?(o=r.split("="),i=o[0],l=o[1],a=new t.Add(e.stringToExpression(l),new t.Mul(e.stringToExpression(i),"-1")),new n(a)):new n(r)
},o.raw={Add:t.Add,Mul:t.Mul,Pow:t.Pow,Terminal:i.Terminal,Variable:i.Variable,Constant:i.Constant,SymbolicConstant:i.SymbolicConstant,Uncertainty:i.Uncertainty},o})}.call(this),n("coffeequate")});